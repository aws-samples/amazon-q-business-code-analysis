Description: (uksb-1tupboc54) - Amazon Q Business Code Analysis stack
Parameters:
  ProjectName:
    Type: String
    AllowedPattern: ^[a-zA-Z0-9][a-zA-Z0-9_-]*$
    Description: The project name, for example langchain-agents.
  RepositoryGitUrl:
    Type: String
    AllowedPattern: ^https?://.+(.git)$
    Description: The Git URL of the repository to scan and ingest into Amazon Q Business. Note it should end with .git, i.e. https://github.com/aws-samples/langchain-agents.git
  QAppUserId:
    Type: String
    Description: The user ID of the Amazon Q Business user. At the time of writing, any value will be accepted.
Resources:
  QIamConstruct1453QIamRole990B6ABC:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service: qbusiness.amazonaws.com
        Version: "2012-10-17"
      Policies:
        - PolicyDocument:
            Statement:
              - Action: cloudwatch:PutMetricData
                Effect: Allow
                Resource: "*"
            Version: "2012-10-17"
          PolicyName: AmazonQApplicationPutMetricDataPermission
        - PolicyDocument:
            Statement:
              - Action: logs:DescribeLogGroups
                Effect: Allow
                Resource: "*"
            Version: "2012-10-17"
          PolicyName: AmazonQApplicationDescribeLogGroupsPermission
        - PolicyDocument:
            Statement:
              - Action: logs:CreateLogGroup
                Effect: Allow
                Resource: arn:aws:logs:us-east-1:*:log-group:/aws/qbusiness/*
            Version: "2012-10-17"
          PolicyName: AmazonQApplicationCreateLogGroupPermission
        - PolicyDocument:
            Statement:
              - Action:
                  - logs:CreateLogStream
                  - logs:DescribeLogStreams
                  - logs:PutLogEvents
                Effect: Allow
                Resource: arn:aws:logs:us-east-1:*:log-group:/aws/qbusiness/*:log-stream:*
            Version: "2012-10-17"
          PolicyName: AmazonQApplicationLogStreamPermission
      RoleName: QBusiness-Application-1453
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/QIamConstruct-1453/QIamRole/Resource
  layerWithQBusinessB00C1A25:
    Type: AWS::Lambda::LayerVersion
    Properties:
      CompatibleRuntimes:
        - python3.12
      Content:
        S3Bucket:
          Fn::Sub: us-east-1-amazon-q-business-code-analysis
        S3Key: 8e03a01484bead4cdeec30f1ca8373edebb48221ad9fd392517ecca98e86340d.zip
      Description: Boto3 v1.34.40
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/layerWithQBusiness/Resource
      aws:asset:path: asset.8e03a01484bead4cdeec30f1ca8373edebb48221ad9fd392517ecca98e86340d.zip
      aws:asset:is-bundled: false
      aws:asset:property: Content
  QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service: lambda.amazonaws.com
        Version: "2012-10-17"
    DependsOn:
      - layerWithQBusinessB00C1A25
      - QIamConstruct1453QIamRole990B6ABC
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/QBusinessAppConstruct/QBusinessCustomLambdaRole/Resource
  QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - qbusiness:CreateApplication
              - qbusiness:CreateIndex
              - qbusiness:CreateRetriever
              - qbusiness:DeleteApplication
              - qbusiness:DeleteIndex
              - qbusiness:DeleteRetriever
              - qbusiness:GetApplication
              - qbusiness:GetIndex
              - qbusiness:GetRetriever
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:aws:qbusiness:"
                  - Ref: AWS::Region
                  - ":"
                  - Ref: AWS::AccountId
                  - :application/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::GetAtt:
                - QIamConstruct1453QIamRole990B6ABC
                - Arn
        Version: "2012-10-17"
      PolicyName: QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      Roles:
        - Ref: QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
    DependsOn:
      - layerWithQBusinessB00C1A25
      - QIamConstruct1453QIamRole990B6ABC
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/QBusinessAppConstruct/QBusinessCustomLambdaRole/DefaultPolicy/Resource
  QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1:
    Type: AWS::Lambda::Function
    Properties:
      Architectures:
        - arm64
      Code:
        S3Bucket:
          Fn::Sub: us-east-1-amazon-q-business-code-analysis
        S3Key: 126c99b691c623dfb25773399e250efe3d83f4de5e7a0933e5447a13ca45a03b.zip
      Environment:
        Variables:
          Q_APP_NAME:
            Fn::Join:
              - ""
              - - Ref: ProjectName
                - "-1453"
          Q_APP_ROLE_ARN:
            Fn::GetAtt:
              - QIamConstruct1453QIamRole990B6ABC
              - Arn
      Handler: amazon_q_app_resource.on_event
      Layers:
        - Ref: layerWithQBusinessB00C1A25
      Role:
        Fn::GetAtt:
          - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
          - Arn
      Runtime: python3.12
      Timeout: 600
    DependsOn:
      - layerWithQBusinessB00C1A25
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QIamConstruct1453QIamRole990B6ABC
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/QBusinessAppConstruct/QBusinessCreateDeleteAppFunction/Resource
      aws:asset:path: asset.126c99b691c623dfb25773399e250efe3d83f4de5e7a0933e5447a13ca45a03b
      aws:asset:is-bundled: false
      aws:asset:property: Code
  QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service: lambda.amazonaws.com
        Version: "2012-10-17"
      ManagedPolicyArns:
        - Fn::Join:
            - ""
            - - "arn:"
              - Ref: AWS::Partition
              - :iam::aws:policy/service-role/AWSLambdaBasicExecutionRole
    DependsOn:
      - layerWithQBusinessB00C1A25
      - QIamConstruct1453QIamRole990B6ABC
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/QBusinessAppConstruct/QBusinessHandleAppChanges/framework-onEvent/ServiceRole/Resource
  QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action: lambda:InvokeFunction
            Effect: Allow
            Resource:
              - Fn::GetAtt:
                  - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
                  - Arn
              - Fn::Join:
                  - ""
                  - - Fn::GetAtt:
                        - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
                        - Arn
                    - :*
        Version: "2012-10-17"
      PolicyName: QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      Roles:
        - Ref: QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    DependsOn:
      - layerWithQBusinessB00C1A25
      - QIamConstruct1453QIamRole990B6ABC
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/QBusinessAppConstruct/QBusinessHandleAppChanges/framework-onEvent/ServiceRole/DefaultPolicy/Resource
  QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D:
    Type: AWS::Lambda::Function
    Properties:
      Code:
        S3Bucket:
          Fn::Sub: us-east-1-amazon-q-business-code-analysis
        S3Key: 7382a0addb9f34974a1ea6c6c9b063882af874828f366f5c93b2b7b64db15c94.zip
      Description: AWS CDK resource provider framework - onEvent (QBusinessCodeAnalysisCdkStack/QBusinessAppConstruct/QBusinessHandleAppChanges)
      Environment:
        Variables:
          USER_ON_EVENT_FUNCTION_ARN:
            Fn::GetAtt:
              - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
              - Arn
      Handler: framework.onEvent
      Role:
        Fn::GetAtt:
          - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
          - Arn
      Runtime: nodejs18.x
      Timeout: 900
    DependsOn:
      - layerWithQBusinessB00C1A25
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
      - QIamConstruct1453QIamRole990B6ABC
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/QBusinessAppConstruct/QBusinessHandleAppChanges/framework-onEvent/Resource
      aws:asset:path: asset.7382a0addb9f34974a1ea6c6c9b063882af874828f366f5c93b2b7b64db15c94
      aws:asset:is-bundled: false
      aws:asset:property: Code
  QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D:
    Type: Custom::LogRetention
    Properties:
      ServiceToken:
        Fn::GetAtt:
          - LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aFD4BFC8A
          - Arn
      LogGroupName:
        Fn::Join:
          - ""
          - - /aws/lambda/
            - Ref: QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      RetentionInDays: 1
    DependsOn:
      - layerWithQBusinessB00C1A25
      - QIamConstruct1453QIamRole990B6ABC
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/QBusinessAppConstruct/QBusinessHandleAppChanges/framework-onEvent/LogRetention/Resource
  QBusinessAppConstructQBusinessAppCfnHookD812AF32:
    Type: AWS::CloudFormation::CustomResource
    Properties:
      ServiceToken:
        Fn::GetAtt:
          - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
          - Arn
    DependsOn:
      - layerWithQBusinessB00C1A25
      - QIamConstruct1453QIamRole990B6ABC
    UpdateReplacePolicy: Delete
    DeletionPolicy: Delete
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/QBusinessAppConstruct/QBusinessAppCfnHook/Default
  LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service: lambda.amazonaws.com
        Version: "2012-10-17"
      ManagedPolicyArns:
        - Fn::Join:
            - ""
            - - "arn:"
              - Ref: AWS::Partition
              - :iam::aws:policy/service-role/AWSLambdaBasicExecutionRole
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole/Resource
  LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRoleDefaultPolicyADDA7DEB:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - logs:DeleteRetentionPolicy
              - logs:PutRetentionPolicy
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRoleDefaultPolicyADDA7DEB
      Roles:
        - Ref: LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole/DefaultPolicy/Resource
  LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aFD4BFC8A:
    Type: AWS::Lambda::Function
    Properties:
      Handler: index.handler
      Runtime: nodejs18.x
      Timeout: 900
      Code:
        S3Bucket:
          Fn::Sub: us-east-1-amazon-q-business-code-analysis
        S3Key: 5bc602ecde93c947efe5899ae355f999986a1acbe610b1c0b9c468d738857555.zip
      Role:
        Fn::GetAtt:
          - LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB
          - Arn
    DependsOn:
      - LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRoleDefaultPolicyADDA7DEB
      - LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/Resource
      aws:asset:path: asset.5bc602ecde93c947efe5899ae355f999986a1acbe610b1c0b9c468d738857555
      aws:asset:is-bundled: false
      aws:asset:property: Code
  AwsBatchConstructVpc94EC4FC3:
    Type: AWS::EC2::VPC
    Properties:
      CidrBlock: 10.0.0.0/16
      EnableDnsHostnames: true
      EnableDnsSupport: true
      InstanceTenancy: default
      Tags:
        - Key: Name
          Value: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/Resource
  AwsBatchConstructVpcPublicSubnet1SubnetC4616B42:
    Type: AWS::EC2::Subnet
    Properties:
      AvailabilityZone:
        Fn::Select:
          - 0
          - Fn::GetAZs: ""
      CidrBlock: 10.0.0.0/18
      MapPublicIpOnLaunch: true
      Tags:
        - Key: aws-cdk:subnet-name
          Value: Public
        - Key: aws-cdk:subnet-type
          Value: Public
        - Key: Name
          Value: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PublicSubnet1
      VpcId:
        Ref: AwsBatchConstructVpc94EC4FC3
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PublicSubnet1/Subnet
  AwsBatchConstructVpcPublicSubnet1RouteTable778FF60E:
    Type: AWS::EC2::RouteTable
    Properties:
      Tags:
        - Key: Name
          Value: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PublicSubnet1
      VpcId:
        Ref: AwsBatchConstructVpc94EC4FC3
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PublicSubnet1/RouteTable
  AwsBatchConstructVpcPublicSubnet1RouteTableAssociation38F37696:
    Type: AWS::EC2::SubnetRouteTableAssociation
    Properties:
      RouteTableId:
        Ref: AwsBatchConstructVpcPublicSubnet1RouteTable778FF60E
      SubnetId:
        Ref: AwsBatchConstructVpcPublicSubnet1SubnetC4616B42
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PublicSubnet1/RouteTableAssociation
  AwsBatchConstructVpcPublicSubnet1DefaultRouteB7669FFF:
    Type: AWS::EC2::Route
    Properties:
      DestinationCidrBlock: 0.0.0.0/0
      GatewayId:
        Ref: AwsBatchConstructVpcIGWF8512AC5
      RouteTableId:
        Ref: AwsBatchConstructVpcPublicSubnet1RouteTable778FF60E
    DependsOn:
      - AwsBatchConstructVpcVPCGWFFFC40BF
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PublicSubnet1/DefaultRoute
  AwsBatchConstructVpcPublicSubnet1EIP35F824C5:
    Type: AWS::EC2::EIP
    Properties:
      Domain: vpc
      Tags:
        - Key: Name
          Value: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PublicSubnet1
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PublicSubnet1/EIP
  AwsBatchConstructVpcPublicSubnet1NATGatewayDC0EF7DB:
    Type: AWS::EC2::NatGateway
    Properties:
      AllocationId:
        Fn::GetAtt:
          - AwsBatchConstructVpcPublicSubnet1EIP35F824C5
          - AllocationId
      SubnetId:
        Ref: AwsBatchConstructVpcPublicSubnet1SubnetC4616B42
      Tags:
        - Key: Name
          Value: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PublicSubnet1
    DependsOn:
      - AwsBatchConstructVpcPublicSubnet1DefaultRouteB7669FFF
      - AwsBatchConstructVpcPublicSubnet1RouteTableAssociation38F37696
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PublicSubnet1/NATGateway
  AwsBatchConstructVpcPublicSubnet2SubnetB89DF273:
    Type: AWS::EC2::Subnet
    Properties:
      AvailabilityZone:
        Fn::Select:
          - 1
          - Fn::GetAZs: ""
      CidrBlock: 10.0.64.0/18
      MapPublicIpOnLaunch: true
      Tags:
        - Key: aws-cdk:subnet-name
          Value: Public
        - Key: aws-cdk:subnet-type
          Value: Public
        - Key: Name
          Value: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PublicSubnet2
      VpcId:
        Ref: AwsBatchConstructVpc94EC4FC3
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PublicSubnet2/Subnet
  AwsBatchConstructVpcPublicSubnet2RouteTable1987A559:
    Type: AWS::EC2::RouteTable
    Properties:
      Tags:
        - Key: Name
          Value: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PublicSubnet2
      VpcId:
        Ref: AwsBatchConstructVpc94EC4FC3
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PublicSubnet2/RouteTable
  AwsBatchConstructVpcPublicSubnet2RouteTableAssociation1E341469:
    Type: AWS::EC2::SubnetRouteTableAssociation
    Properties:
      RouteTableId:
        Ref: AwsBatchConstructVpcPublicSubnet2RouteTable1987A559
      SubnetId:
        Ref: AwsBatchConstructVpcPublicSubnet2SubnetB89DF273
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PublicSubnet2/RouteTableAssociation
  AwsBatchConstructVpcPublicSubnet2DefaultRouteA3A4A04F:
    Type: AWS::EC2::Route
    Properties:
      DestinationCidrBlock: 0.0.0.0/0
      GatewayId:
        Ref: AwsBatchConstructVpcIGWF8512AC5
      RouteTableId:
        Ref: AwsBatchConstructVpcPublicSubnet2RouteTable1987A559
    DependsOn:
      - AwsBatchConstructVpcVPCGWFFFC40BF
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PublicSubnet2/DefaultRoute
  AwsBatchConstructVpcPublicSubnet2EIP4993F697:
    Type: AWS::EC2::EIP
    Properties:
      Domain: vpc
      Tags:
        - Key: Name
          Value: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PublicSubnet2
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PublicSubnet2/EIP
  AwsBatchConstructVpcPublicSubnet2NATGateway454ECA6D:
    Type: AWS::EC2::NatGateway
    Properties:
      AllocationId:
        Fn::GetAtt:
          - AwsBatchConstructVpcPublicSubnet2EIP4993F697
          - AllocationId
      SubnetId:
        Ref: AwsBatchConstructVpcPublicSubnet2SubnetB89DF273
      Tags:
        - Key: Name
          Value: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PublicSubnet2
    DependsOn:
      - AwsBatchConstructVpcPublicSubnet2DefaultRouteA3A4A04F
      - AwsBatchConstructVpcPublicSubnet2RouteTableAssociation1E341469
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PublicSubnet2/NATGateway
  AwsBatchConstructVpcPrivateSubnet1Subnet1B53BB99:
    Type: AWS::EC2::Subnet
    Properties:
      AvailabilityZone:
        Fn::Select:
          - 0
          - Fn::GetAZs: ""
      CidrBlock: 10.0.128.0/18
      MapPublicIpOnLaunch: false
      Tags:
        - Key: aws-cdk:subnet-name
          Value: Private
        - Key: aws-cdk:subnet-type
          Value: Private
        - Key: Name
          Value: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PrivateSubnet1
      VpcId:
        Ref: AwsBatchConstructVpc94EC4FC3
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PrivateSubnet1/Subnet
  AwsBatchConstructVpcPrivateSubnet1RouteTable06823197:
    Type: AWS::EC2::RouteTable
    Properties:
      Tags:
        - Key: Name
          Value: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PrivateSubnet1
      VpcId:
        Ref: AwsBatchConstructVpc94EC4FC3
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PrivateSubnet1/RouteTable
  AwsBatchConstructVpcPrivateSubnet1RouteTableAssociation37D35DEC:
    Type: AWS::EC2::SubnetRouteTableAssociation
    Properties:
      RouteTableId:
        Ref: AwsBatchConstructVpcPrivateSubnet1RouteTable06823197
      SubnetId:
        Ref: AwsBatchConstructVpcPrivateSubnet1Subnet1B53BB99
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PrivateSubnet1/RouteTableAssociation
  AwsBatchConstructVpcPrivateSubnet1DefaultRoute0704CE1D:
    Type: AWS::EC2::Route
    Properties:
      DestinationCidrBlock: 0.0.0.0/0
      NatGatewayId:
        Ref: AwsBatchConstructVpcPublicSubnet1NATGatewayDC0EF7DB
      RouteTableId:
        Ref: AwsBatchConstructVpcPrivateSubnet1RouteTable06823197
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PrivateSubnet1/DefaultRoute
  AwsBatchConstructVpcPrivateSubnet2Subnet48165E34:
    Type: AWS::EC2::Subnet
    Properties:
      AvailabilityZone:
        Fn::Select:
          - 1
          - Fn::GetAZs: ""
      CidrBlock: 10.0.192.0/18
      MapPublicIpOnLaunch: false
      Tags:
        - Key: aws-cdk:subnet-name
          Value: Private
        - Key: aws-cdk:subnet-type
          Value: Private
        - Key: Name
          Value: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PrivateSubnet2
      VpcId:
        Ref: AwsBatchConstructVpc94EC4FC3
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PrivateSubnet2/Subnet
  AwsBatchConstructVpcPrivateSubnet2RouteTable246A5D99:
    Type: AWS::EC2::RouteTable
    Properties:
      Tags:
        - Key: Name
          Value: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PrivateSubnet2
      VpcId:
        Ref: AwsBatchConstructVpc94EC4FC3
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PrivateSubnet2/RouteTable
  AwsBatchConstructVpcPrivateSubnet2RouteTableAssociation124B23F5:
    Type: AWS::EC2::SubnetRouteTableAssociation
    Properties:
      RouteTableId:
        Ref: AwsBatchConstructVpcPrivateSubnet2RouteTable246A5D99
      SubnetId:
        Ref: AwsBatchConstructVpcPrivateSubnet2Subnet48165E34
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PrivateSubnet2/RouteTableAssociation
  AwsBatchConstructVpcPrivateSubnet2DefaultRouteB810E441:
    Type: AWS::EC2::Route
    Properties:
      DestinationCidrBlock: 0.0.0.0/0
      NatGatewayId:
        Ref: AwsBatchConstructVpcPublicSubnet2NATGateway454ECA6D
      RouteTableId:
        Ref: AwsBatchConstructVpcPrivateSubnet2RouteTable246A5D99
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/PrivateSubnet2/DefaultRoute
  AwsBatchConstructVpcIGWF8512AC5:
    Type: AWS::EC2::InternetGateway
    Properties:
      Tags:
        - Key: Name
          Value: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/IGW
  AwsBatchConstructVpcVPCGWFFFC40BF:
    Type: AWS::EC2::VPCGatewayAttachment
    Properties:
      InternetGatewayId:
        Ref: AwsBatchConstructVpcIGWF8512AC5
      VpcId:
        Ref: AwsBatchConstructVpc94EC4FC3
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/VPCGW
  AwsBatchConstructVpcRestrictDefaultSecurityGroupCustomResourceE34A47F8:
    Type: Custom::VpcRestrictDefaultSG
    Properties:
      ServiceToken:
        Fn::GetAtt:
          - CustomVpcRestrictDefaultSGCustomResourceProviderHandlerDC833E5E
          - Arn
      DefaultSecurityGroupId:
        Fn::GetAtt:
          - AwsBatchConstructVpc94EC4FC3
          - DefaultSecurityGroup
      Account:
        Ref: AWS::AccountId
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    UpdateReplacePolicy: Delete
    DeletionPolicy: Delete
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/Vpc/RestrictDefaultSecurityGroupCustomResource/Default
  AwsBatchConstructQScriptComputeEnvSecurityGroupBF3DC2A5:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/QScriptComputeEnv/SecurityGroup
      SecurityGroupEgress:
        - CidrIp: 0.0.0.0/0
          Description: Allow all outbound traffic by default
          IpProtocol: "-1"
      VpcId:
        Ref: AwsBatchConstructVpc94EC4FC3
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/QScriptComputeEnv/SecurityGroup/Resource
  AwsBatchConstructQScriptComputeEnv68DACBBA:
    Type: AWS::Batch::ComputeEnvironment
    Properties:
      ComputeResources:
        MaxvCpus: 256
        SecurityGroupIds:
          - Fn::GetAtt:
              - AwsBatchConstructQScriptComputeEnvSecurityGroupBF3DC2A5
              - GroupId
        Subnets:
          - Ref: AwsBatchConstructVpcPrivateSubnet1Subnet1B53BB99
          - Ref: AwsBatchConstructVpcPrivateSubnet2Subnet48165E34
        Type: FARGATE
      ReplaceComputeEnvironment: false
      State: ENABLED
      Type: managed
      UpdatePolicy: {}
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/QScriptComputeEnv/Resource
  AwsBatchConstructQProcessingJobQueue401A8E7A:
    Type: AWS::Batch::JobQueue
    Properties:
      ComputeEnvironmentOrder:
        - ComputeEnvironment:
            Fn::GetAtt:
              - AwsBatchConstructQScriptComputeEnv68DACBBA
              - ComputeEnvironmentArn
          Order: 1
      Priority: 1
      State: ENABLED
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/QProcessingJobQueue/Resource
  AwsBatchConstructQProcessingJobExecutionRoleC8809EBB:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service: ecs-tasks.amazonaws.com
        Version: "2012-10-17"
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/QProcessingJobExecutionRole/Resource
  AwsBatchConstructQProcessingJobExecutionRoleDefaultPolicy1A4792BA:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - qbusiness:BatchPutDocument
              - qbusiness:ChatSync
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:aws:qbusiness:"
                  - Ref: AWS::Region
                  - ":"
                  - Ref: AWS::AccountId
                  - :application/*
          - Action:
              - logs:CreateLogGroup
              - logs:CreateLogStream
              - logs:PutLogEvents
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:aws:logs:"
                  - Ref: AWS::Region
                  - ":"
                  - Ref: AWS::AccountId
                  - :log-group:/aws/batch/*
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::GetAtt:
                - QIamConstruct1453QIamRole990B6ABC
                - Arn
        Version: "2012-10-17"
      PolicyName: AwsBatchConstructQProcessingJobExecutionRoleDefaultPolicy1A4792BA
      Roles:
        - Ref: AwsBatchConstructQProcessingJobExecutionRoleC8809EBB
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/QProcessingJobExecutionRole/DefaultPolicy/Resource
  AwsBatchConstructQBusinessJob0F51F50F:
    Type: AWS::Batch::JobDefinition
    Properties:
      ContainerProperties:
        Environment: []
        EphemeralStorage:
          SizeInGiB: 21
        ExecutionRoleArn:
          Fn::GetAtt:
            - AwsBatchConstructQProcessingJobExecutionRoleC8809EBB
            - Arn
        FargatePlatformConfiguration: {}
        Image: public.ecr.aws/amazonlinux/amazonlinux:latest
        JobRoleArn:
          Fn::GetAtt:
            - AwsBatchConstructQProcessingJobExecutionRoleC8809EBB
            - Arn
        NetworkConfiguration:
          AssignPublicIp: DISABLED
        ReadonlyRootFilesystem: false
        ResourceRequirements:
          - Type: MEMORY
            Value: "2048"
          - Type: VCPU
            Value: "1"
      PlatformCapabilities:
        - FARGATE
      RetryStrategy: {}
      Timeout: {}
      Type: container
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/QBusinessJob/Resource
  AwsBatchConstructQBusinessSubmitJobRoleBC566CF1:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service: lambda.amazonaws.com
        Version: "2012-10-17"
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/QBusinessSubmitJobRole/Resource
  AwsBatchConstructQBusinessSubmitJobRoleDefaultPolicyAEB70587:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - qbusiness:ListApplications
              - qbusiness:ListIndices
            Effect: Allow
            Resource: "*"
          - Action: iam:PassRole
            Effect: Allow
            Resource:
              Fn::GetAtt:
                - AwsBatchConstructQProcessingJobExecutionRoleC8809EBB
                - Arn
          - Action:
              - logs:CreateLogGroup
              - logs:CreateLogStream
              - logs:PutLogEvents
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:aws:logs:"
                  - Ref: AWS::Region
                  - ":"
                  - Ref: AWS::AccountId
                  - :log-group:/aws/lambda/*
          - Action: batch:SubmitJob
            Effect: Allow
            Resource:
              - Fn::GetAtt:
                  - AwsBatchConstructQProcessingJobQueue401A8E7A
                  - JobQueueArn
              - Ref: AwsBatchConstructQBusinessJob0F51F50F
        Version: "2012-10-17"
      PolicyName: AwsBatchConstructQBusinessSubmitJobRoleDefaultPolicyAEB70587
      Roles:
        - Ref: AwsBatchConstructQBusinessSubmitJobRoleBC566CF1
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/QBusinessSubmitJobRole/DefaultPolicy/Resource
  AwsBatchConstructQBusinessSubmitJobLambda18C43E50:
    Type: AWS::Lambda::Function
    Properties:
      Code:
        S3Bucket:
          Fn::Sub: us-east-1-amazon-q-business-code-analysis
        S3Key: a0d5c55d46bd283b1d09644c05d6c85df9268608a67e6477fcf0bb4d47078017.zip
      Environment:
        Variables:
          BATCH_JOB_DEFINITION:
            Ref: AwsBatchConstructQBusinessJob0F51F50F
          BATCH_JOB_QUEUE:
            Fn::GetAtt:
              - AwsBatchConstructQProcessingJobQueue401A8E7A
              - JobQueueArn
          REPO_URL:
            Ref: RepositoryGitUrl
          Q_APP_NAME:
            Fn::Join:
              - ""
              - - Ref: ProjectName
                - "-1453"
          Q_APP_ROLE_ARN:
            Fn::GetAtt:
              - QIamConstruct1453QIamRole990B6ABC
              - Arn
          S3_BUCKET: us-east-1-amazon-q-business-code-analysis
          Q_APP_USER_ID:
            Ref: QAppUserId
      Handler: submit_batch_job.on_event
      Layers:
        - Ref: layerWithQBusinessB00C1A25
      MemorySize: 512
      Role:
        Fn::GetAtt:
          - AwsBatchConstructQBusinessSubmitJobRoleBC566CF1
          - Arn
      Runtime: python3.12
      Timeout: 300
    DependsOn:
      - AwsBatchConstructQBusinessJob0F51F50F
      - AwsBatchConstructQBusinessSubmitJobRoleDefaultPolicyAEB70587
      - AwsBatchConstructQBusinessSubmitJobRoleBC566CF1
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/QBusinessSubmitJobLambda/Resource
      aws:asset:path: asset.a0d5c55d46bd283b1d09644c05d6c85df9268608a67e6477fcf0bb4d47078017
      aws:asset:is-bundled: false
      aws:asset:property: Code
  AwsBatchConstructQBuinessSubmitJobLambdaProviderframeworkonEventServiceRole401FA607:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service: lambda.amazonaws.com
        Version: "2012-10-17"
      ManagedPolicyArns:
        - Fn::Join:
            - ""
            - - "arn:"
              - Ref: AWS::Partition
              - :iam::aws:policy/service-role/AWSLambdaBasicExecutionRole
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/QBuinessSubmitJobLambdaProvider/framework-onEvent/ServiceRole/Resource
  AwsBatchConstructQBuinessSubmitJobLambdaProviderframeworkonEventServiceRoleDefaultPolicyA0325A61:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action: lambda:InvokeFunction
            Effect: Allow
            Resource:
              - Fn::GetAtt:
                  - AwsBatchConstructQBusinessSubmitJobLambda18C43E50
                  - Arn
              - Fn::Join:
                  - ""
                  - - Fn::GetAtt:
                        - AwsBatchConstructQBusinessSubmitJobLambda18C43E50
                        - Arn
                    - :*
        Version: "2012-10-17"
      PolicyName: AwsBatchConstructQBuinessSubmitJobLambdaProviderframeworkonEventServiceRoleDefaultPolicyA0325A61
      Roles:
        - Ref: AwsBatchConstructQBuinessSubmitJobLambdaProviderframeworkonEventServiceRole401FA607
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/QBuinessSubmitJobLambdaProvider/framework-onEvent/ServiceRole/DefaultPolicy/Resource
  AwsBatchConstructQBuinessSubmitJobLambdaProviderframeworkonEvent6174C53A:
    Type: AWS::Lambda::Function
    Properties:
      Code:
        S3Bucket:
          Fn::Sub: us-east-1-amazon-q-business-code-analysis
        S3Key: 7382a0addb9f34974a1ea6c6c9b063882af874828f366f5c93b2b7b64db15c94.zip
      Description: AWS CDK resource provider framework - onEvent (QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/QBuinessSubmitJobLambdaProvider)
      Environment:
        Variables:
          USER_ON_EVENT_FUNCTION_ARN:
            Fn::GetAtt:
              - AwsBatchConstructQBusinessSubmitJobLambda18C43E50
              - Arn
      Handler: framework.onEvent
      Role:
        Fn::GetAtt:
          - AwsBatchConstructQBuinessSubmitJobLambdaProviderframeworkonEventServiceRole401FA607
          - Arn
      Runtime: nodejs18.x
      Timeout: 900
    DependsOn:
      - AwsBatchConstructQBuinessSubmitJobLambdaProviderframeworkonEventServiceRoleDefaultPolicyA0325A61
      - AwsBatchConstructQBuinessSubmitJobLambdaProviderframeworkonEventServiceRole401FA607
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/QBuinessSubmitJobLambdaProvider/framework-onEvent/Resource
      aws:asset:path: asset.7382a0addb9f34974a1ea6c6c9b063882af874828f366f5c93b2b7b64db15c94
      aws:asset:is-bundled: false
      aws:asset:property: Code
  AwsBatchConstructQBuinessSubmitJobLambdaProviderframeworkonEventLogRetention383105C9:
    Type: Custom::LogRetention
    Properties:
      ServiceToken:
        Fn::GetAtt:
          - LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aFD4BFC8A
          - Arn
      LogGroupName:
        Fn::Join:
          - ""
          - - /aws/lambda/
            - Ref: AwsBatchConstructQBuinessSubmitJobLambdaProviderframeworkonEvent6174C53A
      RetentionInDays: 1
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/QBuinessSubmitJobLambdaProvider/framework-onEvent/LogRetention/Resource
  AwsBatchConstructQBusinessSubmitJobLambdaCustomResource61CB27B7:
    Type: AWS::CloudFormation::CustomResource
    Properties:
      ServiceToken:
        Fn::GetAtt:
          - AwsBatchConstructQBuinessSubmitJobLambdaProviderframeworkonEvent6174C53A
          - Arn
    DependsOn:
      - QBusinessAppConstructQBusinessAppCfnHookD812AF32
      - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
      - QBusinessAppConstructQBusinessCustomLambdaRoleDefaultPolicy9F97DF18
      - QBusinessAppConstructQBusinessCustomLambdaRoleFE6EB133
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventLogRetentionE88FE07D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEvent14A36F0D
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRoleDefaultPolicy1900294B
      - QBusinessAppConstructQBusinessHandleAppChangesframeworkonEventServiceRole3768E106
    UpdateReplacePolicy: Delete
    DeletionPolicy: Delete
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/AwsBatchConstruct/QBusinessSubmitJobLambdaCustomResource/Default
  CustomVpcRestrictDefaultSGCustomResourceProviderRole26592FE0:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Version: "2012-10-17"
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service: lambda.amazonaws.com
      ManagedPolicyArns:
        - Fn::Sub: arn:${AWS::Partition}:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole
      Policies:
        - PolicyName: Inline
          PolicyDocument:
            Version: "2012-10-17"
            Statement:
              - Effect: Allow
                Action:
                  - ec2:AuthorizeSecurityGroupIngress
                  - ec2:AuthorizeSecurityGroupEgress
                  - ec2:RevokeSecurityGroupIngress
                  - ec2:RevokeSecurityGroupEgress
                Resource:
                  - Fn::Join:
                      - ""
                      - - "arn:"
                        - Ref: AWS::Partition
                        - ":ec2:"
                        - Ref: AWS::Region
                        - ":"
                        - Ref: AWS::AccountId
                        - :security-group/
                        - Fn::GetAtt:
                            - AwsBatchConstructVpc94EC4FC3
                            - DefaultSecurityGroup
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/Custom::VpcRestrictDefaultSGCustomResourceProvider/Role
  CustomVpcRestrictDefaultSGCustomResourceProviderHandlerDC833E5E:
    Type: AWS::Lambda::Function
    Properties:
      Code:
        S3Bucket:
          Fn::Sub: us-east-1-amazon-q-business-code-analysis
        S3Key: 7f18a11296f35510ee16538afec983ed6312e12afbf81b777089a9f8e34e2474.zip
      Timeout: 900
      MemorySize: 128
      Handler: __entrypoint__.handler
      Role:
        Fn::GetAtt:
          - CustomVpcRestrictDefaultSGCustomResourceProviderRole26592FE0
          - Arn
      Runtime: nodejs18.x
      Description: Lambda function for removing all inbound/outbound rules from the VPC default security group
    DependsOn:
      - CustomVpcRestrictDefaultSGCustomResourceProviderRole26592FE0
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/Custom::VpcRestrictDefaultSGCustomResourceProvider/Handler
      aws:asset:path: asset.7f18a11296f35510ee16538afec983ed6312e12afbf81b777089a9f8e34e2474
      aws:asset:property: Code
  CDKMetadata:
    Type: AWS::CDK::Metadata
    Properties:
      Analytics: v2:deflate64:H4sIAAAAAAAA/3VSTW/CMAz9LbuHDNhh2pExQExo68rEFbmpKYE2Qfkoqqr+97kpUCZtJz8/+9kvH2M+Gg358AHOdiDS4yCXCa/XDsSRTXcqAgMFOjSM6ttaQsHrWOfY1kKMdC5FFVoDalgORZICr1dQodmgsVKrtv4rn3sl3KVwxQ2zT1uwFp3lkzZQzl+9OKJ7BYss15nlK53F5EcFMYoxrzcn0U7ZRFMW+YQ8rH2iSExcj2LtHX5D0jnv+J6jbVpIuBoKhRbMllEbPsAtwOEZKhYZWRLsBy8VXQ7ha0Pn5JJNHN3jviC3bI3CG+mqhdH+FDzcEw1LwIk9r+dgMtJOdXEiDzNVSqNVGECSP9h3nXx59MHtDc+Evc1RDqRC84Y7qWQ4IFWp847opD3RNCxGq70RYeynd7SVhRehf5FJlTHhrdPF1lzaLI+MLmVK36S9vps4dP2T3ivIZtqtZkqnyA/2sRy98Gf6lgcr5cB4eu8CedzFH8t4Lt+zAgAA
    Metadata:
      aws:cdk:path: QBusinessCodeAnalysisCdkStack/CDKMetadata/Default
    Condition: CDKMetadataAvailable
Outputs:
  QIamConstruct1453QBusinessRoleArn092F0C21:
    Value:
      Fn::GetAtt:
        - QIamConstruct1453QIamRole990B6ABC
        - Arn
  QBusinessAppConstructQBusinessAppFunctionArn8F74599D:
    Value:
      Fn::GetAtt:
        - QBusinessAppConstructQBusinessCreateDeleteAppFunction84BD82F1
        - Arn
  QBusinessAppName:
    Description: Amazon Q Business Application Name
    Value:
      Fn::Join:
        - ""
        - - Ref: ProjectName
          - "-1453"
Conditions:
  CDKMetadataAvailable:
    Fn::Or:
      - Fn::Or:
          - Fn::Equals:
              - Ref: AWS::Region
              - af-south-1
          - Fn::Equals:
              - Ref: AWS::Region
              - ap-east-1
          - Fn::Equals:
              - Ref: AWS::Region
              - ap-northeast-1
          - Fn::Equals:
              - Ref: AWS::Region
              - ap-northeast-2
          - Fn::Equals:
              - Ref: AWS::Region
              - ap-south-1
          - Fn::Equals:
              - Ref: AWS::Region
              - ap-southeast-1
          - Fn::Equals:
              - Ref: AWS::Region
              - ap-southeast-2
          - Fn::Equals:
              - Ref: AWS::Region
              - ca-central-1
          - Fn::Equals:
              - Ref: AWS::Region
              - cn-north-1
          - Fn::Equals:
              - Ref: AWS::Region
              - cn-northwest-1
      - Fn::Or:
          - Fn::Equals:
              - Ref: AWS::Region
              - eu-central-1
          - Fn::Equals:
              - Ref: AWS::Region
              - eu-north-1
          - Fn::Equals:
              - Ref: AWS::Region
              - eu-south-1
          - Fn::Equals:
              - Ref: AWS::Region
              - eu-west-1
          - Fn::Equals:
              - Ref: AWS::Region
              - eu-west-2
          - Fn::Equals:
              - Ref: AWS::Region
              - eu-west-3
          - Fn::Equals:
              - Ref: AWS::Region
              - me-south-1
          - Fn::Equals:
              - Ref: AWS::Region
              - sa-east-1
          - Fn::Equals:
              - Ref: AWS::Region
              - us-east-1
          - Fn::Equals:
              - Ref: AWS::Region
              - us-east-2
      - Fn::Or:
          - Fn::Equals:
              - Ref: AWS::Region
              - us-west-1
          - Fn::Equals:
              - Ref: AWS::Region
              - us-west-2

